<div class="flex flex-row gap-1 max-w-content" [ngClass]="{'flex-row-reverse': enemy}">
  <!-- Stats Section -->
  <div id="stats" class="bg-center bg-cover w-48 h-64 flex flex-col items-center justify-evenly bg-gray-800 p-4" style="
background-image: url('https://chungus-battles.b-cdn.net/chungus-battles-assets/Item_ID_0_Empty.png');
">
    <h3 class="text-white text-lg mb-4">Stats</h3>
    <div class="w-full rounded-md">
      <div class="text-xs">
        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip"
          matTooltip="Your Health Points, if it reaches zero, you loose the battle." matTooltipPosition="right">
          <div>Health:</div>
          <div class="text-pink-500">{{ getPlayerHp() | number: '1.0-0' }} â¤ï¸</div>
        </div>

        @if (combat) {
        <mat-progress-bar class="red-progress-bar" id="hp" mode="determinate"
          value="{{ (player.hp / player.maxHp) * 100 }}"></mat-progress-bar>
        }

        <mat-divider></mat-divider>

        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip"
          matTooltip="Increases damage of your attacks by {{ player.attack }}." matTooltipPosition="right">
          <div>Attack:</div>
          <div class="text-red-500">{{ player.attack | number: '1.0-0' }} âš”ï¸</div>
        </div>

        <mat-divider></mat-divider>

        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip" matTooltip="Decreases incoming damage from attacks by {{
      100 * (1 - 100 / (100 + player.defense)) | number: '1.0-0'
    }}%." matTooltipPosition="right">
          <div>Defense:</div>
          <div class="text-green-500">{{ player.defense | number: '1.0' }}ğŸ›¡ï¸</div>
        </div>

        <mat-divider></mat-divider>

        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip"
          matTooltip="You attack {{ player.attackSpeed }} times in one second." matTooltipPosition="right">
          <div>Attack Speed:</div>
          <div class="text-blue-500">
            {{ player.attackSpeed | number: '1.3-3' }} â©
          </div>
        </div>

        <mat-divider></mat-divider>

        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip"
          matTooltip="You gain extra {{player.income}}ğŸŸ¡ at the end of fights." matTooltipPosition="right">
          <div>Income:</div>
          <div class="text-yellow-500">
            +{{ player.income }} ğŸ’°
          </div>
        </div>
        <mat-divider></mat-divider>

        <div class="flex flex-row justify-between p-1 hover:bg-slate-700 rounded-sm" #tooltip="matTooltip"
          matTooltip="You recover {{player.hpRegen}}â¤ï¸ every second." matTooltipPosition="right">
          <div>Regen:</div>
          <div class="text-orange-500">
            {{ player.hpRegen }} ğŸ§ª
          </div>
        </div>

      </div>
    </div>

  </div>

  <!-- Avatar Section -->
  <div id="avatar-{{ player.playerId }}"
    class="bg-cover bg-center w-48 h-64 flex flex-col-reverse items-center bg-gray-800 p-4 shadow-lg relative"
    style="background-image: url('{{ getAvatarImage() }}');">
    <div class="relative w-full rounded-md">
      <!-- Floating Damage Numbers Container -->
      <div id="damage-numbers-{{ player.playerId }}" class="relative pointer-events-none"></div>

      <div class="w-full text-center text-white bg-black bg-opacity-40 py-1">
        {{ player ? player.name : 'Avatar Name' }} <br />
        Level: {{ player.level }}
      </div>
    </div>
    <div class="absolute" id="attack-{{ player.playerId }}"></div>
  </div>
  <div id="equiped-items-{{player.playerId}}"
    class="bg-center bg-cover w-48 h-64 flex flex-col items-center justify-evenly bg-gray-800 p-4" style="
  background-image: url('https://chungus-battles.b-cdn.net/chungus-battles-assets/Item_ID_0_Empty.png');
  ">
    <h3>Equiped items</h3>
    @for (item of player.inventory; track $index) {
    @if(item.equipped){
    <div id="{{ item.itemId }}">
      <div class="p-2 " (mouseenter)="onMouseEnterItem(item)" (mouseleave)="onMouseLeaveItem(item)">
        {{ item.name }}
      </div>
    </div>
    @if (item.showDetails) {
    <mat-card-content class="absolute top-0 left-full ml-4 w-48 h-64 flex flex-col items-center justify-evenly 
    bg-gray-800 p-4 shadow-lg border border-gray-600 rounded-lg"
      style="background-image: url('https://chungus-battles.b-cdn.net/chungus-battles-assets/Item_ID_0_Empty.png'); background-size: cover;">
      <div class="mb-2">
        <p class="font-semibold">
          Price: <span class="text-yellow-300">{{ item.price }} ğŸŸ¡</span>
        </p>
      </div>
      <div class="flex flex-1 place-content-center text-xs">
        @if(item.affectedStats.attack !== 0) {
        <p>
          Attack:
          <span class="text-red-500">{{ item.affectedStats.attack }} âš”ï¸</span>
        </p>
        }

        @if(item.affectedStats.attackSpeed !== 0) {
        <p>
          A.speed:
          <span class="text-blue-500">{{ item.affectedStats.attackSpeed * 100 - 100 | number: '1.0-0'}}% â©</span>
        </p>
        }

        @if(item.affectedStats.defense !== 0) {
        <p>
          Defense:
          <span class="text-green-500">{{ item.affectedStats.defense }} ğŸ›¡ï¸</span>
        </p>
        }

        @if(item.affectedStats.hp !== 0) {
        <p>
          Health:
          <span class="text-pink-500">{{ item.affectedStats.hp }} â¤ï¸</span>
        </p>
        }

        @if(item.affectedStats.income !== 0) {
        <p>
          Income:
          <span class="text-yellow-300">{{ item.affectedStats.income }} ğŸ’°</span>
        </p>
        }

      </div>
      <div class="ml-2 mr-2">
        <p class="font-thin text-sm">{{ item.description }}</p>
        @for (tag of item.tags; track $index) {
        <mat-chip class="mr-1 py-1">{{ tag }}</mat-chip>
        }
      </div>
    </mat-card-content>
    }
    }
    }

  </div>
</div>